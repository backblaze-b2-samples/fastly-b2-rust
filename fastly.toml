# Fastly / Backblaze B2 Demo

authors = ["pat@backblaze.com"]
description = " to Provide access to one or more Backblaze B2 Buckets via Fastly Compute@Edge"
language = "rust"
manifest_version = 2
name = "fastly-b2-rust"
service_id = ""

# Edit the backends below to match your B2 bucket and its endpoint

# Local server backend config wants URL
[local_server]
  [local_server.backends]
    [local_server.backends.b2_origin]
      url = "https://s3.us-west-004.backblazeb2.com"

  [local_server.dictionaries]
    [local_server.dictionaries.config]
      format = "inline-toml"
      [local_server.dictionaries.config.contents]
        "allow_list_bucket" = "true"
        "bucket_name" = "$path"
        "endpoint" = "s3.us-west-004.backblazeb2.com"
    [local_server.dictionaries.bucket_auth]
      file = "bucket_auth.json"
      format = "json"

# Deploy on Fastly wants domains and ports
[setup]
  [setup.backends]
    [setup.backends.b2_origin]
      description = "B2 Origin"
      address = "YOUR-B2-ENDPOINT"
      port = 443

  [setup.dictionaries]
    [setup.dictionaries.config]
      [setup.dictionaries.config.items]
        [setup.dictionaries.config.items.allow_list_bucket]
          description = "Set to true to allow clients to list bucket contents"
        [setup.dictionaries.config.items.bucket_name]
          description = "Your Backblaze B2 Bucket's name"
        [setup.dictionaries.config.items.endpoint]
          description = "Your Backblaze B2 Bucket's endpoint"
    [setup.dictionaries.bucket_auth]
      [setup.dictionaries.bucket_auth.items]
        [setup.dictionaries.bucket_auth.items.b2_origin_access_key_id]
          description = "Your B2 Application Key ID"
        [setup.dictionaries.bucket_auth.items.b2_origin_secret_access_key]
          description = "Your B2 Application Key"
